{"$schema":"http://json-schema.org/draft-07/schema#","$id":"frooky.schema.json","title":"frooky JSON API","description":"Schema for defining hooks for frooky.","type":"array","items":{"type":"object","required":["category","hooks"],"properties":{"category":{"type":"string","enum":["STORAGE","CRYPTO","AUTH","NETWORK","PLATFORM","CODE","RESILIENCE","PRIVACY"],"description":"OWASP MAS category"},"hooks":{"type":"array","items":{"oneOf":[{"$ref":"#/definitions/javaHook"},{"$ref":"#/definitions/nativeHook"},{"$ref":"#/definitions/objcHook"},{"$ref":"#/definitions/swiftHook"}]}}}},"definitions":{"debugProperty":{"type":"boolean","description":"Enable verbose logging"},"nativeArgsArray":{"type":"array","items":{"$ref":"#/definitions/nativeArgumentDescriptor"}},"javaOverloads":{"type":"array","items":{"type":"object","required":["args"],"properties":{"args":{"type":"array","items":{"type":"string"},"description":"Frida type signatures (e.g., '[B' for byte array, 'java.lang.String;' for String)"}}},"description":"Specify exact method signatures for overloaded methods"},"javaMethods":{"type":"array","items":{"type":"object","required":["name"],"properties":{"name":{"type":"string","description":"Method name"},"overloads":{"$ref":"#/definitions/javaOverloads","description":"Array of overloads. If not specified, all overloads are hooked."}}},"minItems":1,"required":["name"],"description":"Array of methods to hook"},"javaHookCore":{"type":"object","required":["class","methods"],"properties":{"class":{"type":"string","description":"Fully qualified Java/Kotlin class name"},"methods":{"$ref":"#/definitions/javaMethods"}},"not":{"required":["native"]}},"javaHook":{"allOf":[{"$ref":"#/definitions/javaMethods"},{"type":"object","properties":{"maxFrames":{"type":"integer","minimum":1,"description":"Stack trace depth"},"prerequisites":{"$ref":"#/definitions/javaMethods","description":"These methods are called without arguments before hooking the target function."}}}]},"nativeHook":{"type":"object","required":["native","symbol","module"],"properties":{"native":{"type":"boolean","const":true},"symbol":{"type":"string","description":"Native function symbol name"},"module":{"type":"string","description":"Library/module name (e.g., 'libc.so', 'libssl.so')"},"args":{"$ref":"#/definitions/nativeArgsArray"},"filterEventsByStacktrace":{"type":"array","items":{"type":"string"},"description":"Only capture when stack contains these patterns"},"debug":{"$ref":"#/definitions/debugProperty"}},"not":{"anyOf":[{"required":["objClass"]},{"required":["swiftClass"]}]}},"objcHook":{"type":"object","required":["native","objClass","symbol"],"properties":{"native":{"type":"boolean","const":true},"objClass":{"type":"string","description":"Objective-C class name"},"symbol":{"type":"string","description":"Objective-C method selector (e.g., 'dataTaskWithRequest:completionHandler:')"},"args":{"$ref":"#/definitions/nativeArgsArray"},"debug":{"$ref":"#/definitions/debugProperty"}},"not":{"required":["swiftClass"]}},"swiftHook":{"type":"object","required":["native","swiftClass","symbol"],"properties":{"native":{"type":"boolean","const":true},"swiftClass":{"type":"string","description":"Swift class name (mangled or demangled)"},"symbol":{"type":"string","description":"Swift method name"},"module":{"type":"string","description":"Swift module name (optional)"},"debug":{"$ref":"#/definitions/debugProperty"}},"not":{"required":["objClass"]}},"nativeArgumentDescriptor":{"type":"object","required":["name","type"],"properties":{"name":{"type":"string"},"type":{"type":"string","enum":["string","int32","uint32","int64","pointer","bytes","bool","double","CFData","CFDictionary"],"description":"Native C/C++ types and iOS Foundation types"},"length":{"type":"integer","minimum":1,"description":"Fixed byte length for 'bytes' type"},"lengthInArg":{"type":"integer","minimum":0,"description":"Argument index containing the length"},"direction":{"type":"string","enum":["in","out"],"description":"Parameter direction (out = read after return)"},"returnValue":{"type":"boolean","description":"Capture as return value"},"filter":{"type":"array","items":{"type":"string"},"description":"Only capture when value matches these patterns"}}}}}
